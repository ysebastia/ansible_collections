---
- name: Install packages by operating system
  ansible.builtin.include_tasks: "install_{{ item | lower }}.yml"
  with_first_found:
    - "{{ ansible_facts.distribution | lower }}{{ ansible_facts.distribution_major_version | lower }}.yml"
    - "{{ ansible_facts.distribution | lower }}.yml"
    - "{{ ansible_facts.os_family | lower }}.yml"

- name: Create venv directory
  ansible.builtin.file:
    state: directory
    path: "{{ python_venv_directory }}"
    owner: "{{ ansible_user | default('root') }}"
    group: "{{ ansible_user | default('root') }}"
    mode: "0775"
  notify:
    - Update python virtual environment

- name: Flush handlers
  ansible.builtin.meta: flush_handlers
